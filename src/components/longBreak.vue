<template>
    <div class="long-break long-break-color py-32 w-5/12 cursor-default">
        <div
            class="long-break-title flex items-center px-3 py-0.5 mb-16 font-medium space-x-1.5 text-lg rounded-3xl border-2">
            <svg width="27" height="27" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g id="ph:brain-fill" clip-path="url(#clip0_104_1889)">
                    <path id="Vector"
                        d="M26.0628 14.0005C26.0629 12.9091 25.7532 11.84 25.1699 10.9176C24.5865 9.99512 23.7534 9.25714 22.7672 8.78938V7.82131C22.7665 6.75965 22.424 5.72644 21.7904 4.87457C21.1568 4.0227 20.2658 3.39743 19.2493 3.09131C18.2327 2.78519 17.1446 2.81447 16.146 3.17482C15.1474 3.53517 14.2913 4.20745 13.7044 5.09216C13.1176 4.20745 12.2615 3.53517 11.2629 3.17482C10.2642 2.81447 9.17611 2.78519 8.15955 3.09131C7.14299 3.39743 6.25199 4.0227 5.6184 4.87457C4.98482 5.72644 4.64232 6.75965 4.64159 7.82131V8.78938C3.65533 9.25703 2.82202 9.99496 2.23851 10.9174C1.655 11.8399 1.34525 12.909 1.34525 14.0005C1.34525 15.092 1.655 16.1611 2.23851 17.0836C2.82202 18.0061 3.65533 18.744 4.64159 19.2116V19.3558C4.64232 20.4175 4.98482 21.4507 5.6184 22.3026C6.25199 23.1544 7.14299 23.7797 8.15955 24.0858C9.17611 24.3919 10.2642 24.3627 11.2629 24.0023C12.2615 23.6419 13.1176 22.9697 13.7044 22.085C14.2913 22.9697 15.1474 23.6419 16.146 24.0023C17.1446 24.3627 18.2327 24.3919 19.2493 24.0858C20.2658 23.7797 21.1568 23.1544 21.7904 22.3026C22.424 21.4507 22.7665 20.4175 22.7672 19.3558V19.2116C23.7526 18.7429 24.5851 18.0047 25.1683 17.0824C25.7515 16.1602 26.0617 15.0917 26.0628 14.0005V14.0005ZM9.58495 22.6514C8.77187 22.6509 7.98767 22.3499 7.38312 21.8062C6.77858 21.2624 6.39637 20.5144 6.30998 19.706C6.57568 19.7478 6.84429 19.7685 7.11327 19.7678H7.93716C8.15567 19.7678 8.36523 19.681 8.51974 19.5264C8.67425 19.3719 8.76106 19.1624 8.76106 18.9439C8.76106 18.7254 8.67425 18.5158 8.51974 18.3613C8.36523 18.2068 8.15567 18.12 7.93716 18.12H7.11327C6.14244 18.1183 5.20338 17.7738 4.46177 17.1473C3.72017 16.5208 3.22367 15.6525 3.05987 14.6955C2.89608 13.7386 3.07551 12.7546 3.56651 11.9171C4.05751 11.0796 4.82854 10.4424 5.74355 10.1179C5.90366 10.0589 6.04183 9.95227 6.13943 9.81231C6.23703 9.67236 6.28936 9.50584 6.28938 9.33521V7.82131C6.28938 6.94727 6.63659 6.10903 7.25463 5.49099C7.87267 4.87295 8.71091 4.52574 9.58495 4.52574C10.459 4.52574 11.2972 4.87295 11.9153 5.49099C12.5333 6.10903 12.8805 6.94727 12.8805 7.82131V15.6792C11.9785 14.8606 10.803 14.4087 9.58495 14.4125C9.36644 14.4125 9.15688 14.4993 9.00237 14.6538C8.84786 14.8083 8.76106 15.0178 8.76106 15.2363C8.76106 15.4549 8.84786 15.6644 9.00237 15.8189C9.15688 15.9734 9.36644 16.0602 9.58495 16.0602C10.459 16.0602 11.2972 16.4075 11.9153 17.0255C12.5333 17.6435 12.8805 18.4818 12.8805 19.3558C12.8805 20.2299 12.5333 21.0681 11.9153 21.6861C11.2972 22.3042 10.459 22.6514 9.58495 22.6514ZM20.2956 18.12H19.4717C19.2532 18.12 19.0436 18.2068 18.8891 18.3613C18.7346 18.5158 18.6478 18.7254 18.6478 18.9439C18.6478 19.1624 18.7346 19.3719 18.8891 19.5264C19.0436 19.681 19.2532 19.7678 19.4717 19.7678H20.2956C20.5645 19.7685 20.8332 19.7478 21.0989 19.706C21.0312 20.3393 20.7814 20.9395 20.3798 21.4338C19.9781 21.9282 19.4419 22.2956 18.8358 22.4916C18.2297 22.6875 17.5799 22.7036 16.9648 22.538C16.3498 22.3723 15.796 22.032 15.3703 21.5581C14.9446 21.0843 14.6654 20.4973 14.5664 19.868C14.4674 19.2388 14.5529 18.5944 14.8125 18.0127C15.072 17.4311 15.4946 16.9371 16.0291 16.5906C16.5635 16.2441 17.1869 16.0599 17.8239 16.0602C18.0424 16.0602 18.252 15.9734 18.4065 15.8189C18.561 15.6644 18.6478 15.4549 18.6478 15.2363C18.6478 15.0178 18.561 14.8083 18.4065 14.6538C18.252 14.4993 18.0424 14.4125 17.8239 14.4125C16.6058 14.4087 15.4303 14.8606 14.5283 15.6792V7.82131C14.5283 6.94727 14.8755 6.10903 15.4936 5.49099C16.1116 4.87295 16.9498 4.52574 17.8239 4.52574C18.6979 4.52574 19.5362 4.87295 20.1542 5.49099C20.7722 6.10903 21.1195 6.94727 21.1195 7.82131V9.33521C21.1195 9.50584 21.1718 9.67236 21.2694 9.81231C21.367 9.95227 21.5052 10.0589 21.6653 10.1179C22.5803 10.4424 23.3513 11.0796 23.8423 11.9171C24.3333 12.7546 24.5128 13.7386 24.349 14.6955C24.1852 15.6525 23.6887 16.5208 22.9471 17.1473C22.2055 17.7738 21.2664 18.1183 20.2956 18.12V18.12ZM6.70132 13.5886C6.48281 13.5886 6.27325 13.5018 6.11874 13.3472C5.96423 13.1927 5.87743 12.9832 5.87743 12.7647C5.87743 12.5462 5.96423 12.3366 6.11874 12.1821C6.27325 12.0276 6.48281 11.9408 6.70132 11.9408C7.24677 11.9381 7.76909 11.7202 8.15478 11.3345C8.54047 10.9488 8.75835 10.4265 8.76106 9.88104V9.05715C8.76106 8.83864 8.84786 8.62908 9.00237 8.47457C9.15688 8.32006 9.36644 8.23326 9.58495 8.23326C9.80346 8.23326 10.013 8.32006 10.1675 8.47457C10.322 8.62908 10.4088 8.83864 10.4088 9.05715V9.88104C10.4088 10.8643 10.0182 11.8074 9.32294 12.5027C8.62764 13.1979 7.68462 13.5886 6.70132 13.5886V13.5886ZM21.5314 12.7647C21.5314 12.9832 21.4446 13.1927 21.2901 13.3472C21.1356 13.5018 20.926 13.5886 20.7075 13.5886C19.7242 13.5886 18.7812 13.1979 18.0859 12.5027C17.3906 11.8074 17 10.8643 17 9.88104V9.05715C17 8.83864 17.0868 8.62908 17.2413 8.47457C17.3958 8.32006 17.6054 8.23326 17.8239 8.23326C18.0424 8.23326 18.252 8.32006 18.4065 8.47457C18.561 8.62908 18.6478 8.83864 18.6478 9.05715V9.88104C18.6505 10.4265 18.8684 10.9488 19.254 11.3345C19.6397 11.7202 20.1621 11.9381 20.7075 11.9408C20.926 11.9408 21.1356 12.0276 21.2901 12.1821C21.4446 12.3366 21.5314 12.5462 21.5314 12.7647Z"
                        fill='#153047' />
                </g>
                <defs>
                    <clipPath id="clip0_104_1889">
                        <rect width="26.3646" height="26.3646" fill="white" transform="translate(0.522128 0.40625)" />
                    </clipPath>
                </defs>
            </svg>
            <span>Long Break</span>
        </div>



        <div class="long-break-timer flex flex-col items-center relative">
            <span>{{ padZero(longBreakTime) }}</span>
            <span class="pt-20 pb-10">{{ showSeconds }}</span>
        </div>
        <div :class="{ 'hidden': showDropdown }" class="dropdown long-break-color">
            <drop-down :svgColor="'#153047'" @showModal="showModal"></drop-down>
        </div>


        <div :class="{ 'pointer-events-none': closeBtn !== 3 }" class=" flex items-center space-x-3 mt-3 z-10">
            <button id="dropdownBtn" @click="toggleDropdown"
                class="long-break-btn w-12 h-12 rounded-2xl flex items-center justify-center">
                <svg width="27" height="27" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g id="ph:dots-three-outline-fill">
                        <path id="Vector"
                            d="M16.5165 13.638C16.5165 14.2083 16.3474 14.7658 16.0305 15.24C15.7136 15.7143 15.2633 16.0839 14.7364 16.3021C14.2095 16.5204 13.6297 16.5775 13.0703 16.4662C12.5109 16.3549 11.9971 16.0803 11.5938 15.677C11.1905 15.2737 10.9159 14.7599 10.8046 14.2006C10.6934 13.6412 10.7505 13.0614 10.9687 12.5345C11.187 12.0076 11.5566 11.5572 12.0308 11.2403C12.505 10.9235 13.0625 10.7544 13.6329 10.7544C14.3968 10.7571 15.1287 11.0618 15.6689 11.602C16.2091 12.1422 16.5138 12.874 16.5165 13.638V13.638ZM5.39393 10.7544C4.8236 10.7544 4.26608 10.9235 3.79187 11.2403C3.31766 11.5572 2.94806 12.0076 2.72981 12.5345C2.51155 13.0614 2.45445 13.6412 2.56571 14.2006C2.67698 14.7599 2.95162 15.2737 3.3549 15.677C3.75818 16.0803 4.27199 16.3549 4.83136 16.4662C5.39073 16.5775 5.97053 16.5204 6.49745 16.3021C7.02436 16.0839 7.47472 15.7143 7.79158 15.24C8.10843 14.7658 8.27756 14.2083 8.27756 13.638C8.27484 12.874 7.97016 12.1422 7.42996 11.602C6.88977 11.0618 6.15788 10.7571 5.39393 10.7544V10.7544ZM21.8718 10.7544C21.3015 10.7544 20.7439 10.9235 20.2697 11.2403C19.7955 11.5572 19.4259 12.0076 19.2077 12.5345C18.9894 13.0614 18.9323 13.6412 19.0436 14.2006C19.1548 14.7599 19.4295 15.2737 19.8328 15.677C20.236 16.0803 20.7499 16.3549 21.3092 16.4662C21.8686 16.5775 22.4484 16.5204 22.9753 16.3021C23.5022 16.0839 23.9526 15.7143 24.2694 15.24C24.5863 14.7658 24.7554 14.2083 24.7554 13.638C24.7527 12.874 24.448 12.1422 23.9078 11.602C23.3676 11.0618 22.6357 10.7571 21.8718 10.7544Z"
                            fill='#153047' />
                    </g>
                </svg>
            </button>
            <button @click="runOrpauseTimer"
                class="long-break-play-btn w-20 h-16 rounded-2xl flex items-center justify-center">
                <svg v-if="isIconChanged" width="32" height="32" viewBox="0 0 32 32" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <g id="ph:play-fill">
                        <path id="Vector"
                            d="M30 16C29.9993 16.3439 29.9104 16.6818 29.7419 16.9816C29.5734 17.2814 29.3309 17.533 29.0375 17.7125L11.0375 28.7C10.7377 28.89 10.3914 28.9939 10.0365 29.0006C9.68161 29.0072 9.33171 28.9162 9.02501 28.7375C8.71377 28.5667 8.45432 28.3152 8.27394 28.0095C8.09356 27.7037 7.99893 27.355 8.00001 27V4.99996C7.99893 4.64496 8.09356 4.29623 8.27394 3.99047C8.45432 3.68471 8.71377 3.43322 9.02501 3.26246C9.33171 3.08376 9.68161 2.99275 10.0365 2.99936C10.3914 3.00597 10.7377 3.10996 11.0375 3.29996L29.0375 14.2875C29.3309 14.4669 29.5734 14.7185 29.7419 15.0183C29.9104 15.3181 29.9993 15.6561 30 16Z"
                            fill='#153047' />
                    </g>
                </svg>
                <svg v-else width="27" height="27" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g id="ph:pause-fill">
                        <path id="Vector"
                            d="M22.5628 5.39907V21.8769C22.5628 22.3139 22.3892 22.7331 22.0802 23.0421C21.7712 23.3511 21.3521 23.5247 20.915 23.5247H17.2075C16.7705 23.5247 16.3514 23.3511 16.0424 23.0421C15.7333 22.7331 15.5597 22.3139 15.5597 21.8769V5.39907C15.5597 4.96205 15.7333 4.54293 16.0424 4.23391C16.3514 3.92489 16.7705 3.75128 17.2075 3.75128H20.915C21.3521 3.75128 21.7712 3.92489 22.0802 4.23391C22.3892 4.54293 22.5628 4.96205 22.5628 5.39907ZM9.79248 3.75128H6.08497C5.64795 3.75128 5.22882 3.92489 4.9198 4.23391C4.61078 4.54293 4.43718 4.96205 4.43718 5.39907V21.8769C4.43718 22.3139 4.61078 22.7331 4.9198 23.0421C5.22882 23.3511 5.64795 23.5247 6.08497 23.5247H9.79248C10.2295 23.5247 10.6486 23.3511 10.9576 23.0421C11.2667 22.7331 11.4403 22.3139 11.4403 21.8769V5.39907C11.4403 4.96205 11.2667 4.54293 10.9576 4.23391C10.6486 3.92489 10.2295 3.75128 9.79248 3.75128V3.75128Z"
                            fill='#153047' />
                    </g>
                </svg>
            </button>
            <button @click="nextItem" class="long-break-btn w-12 h-12 rounded-2xl flex items-center justify-center">
                <svg width="27" height="27" viewBox="0 0 27 27" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g id="ph:fast-forward-fill" clip-path="url(#clip0_104_1901)">
                        <path id="Vector"
                            d="M26.2611 13.638C26.2623 13.9142 26.1941 14.1862 26.0627 14.4292C25.9314 14.6721 25.7411 14.8781 25.5093 15.0283L16.3229 20.9294C16.0736 21.091 15.7852 21.1821 15.4884 21.1932C15.1916 21.2043 14.8972 21.1349 14.6366 20.9925C14.3759 20.85 14.1586 20.6397 14.0077 20.3839C13.8567 20.128 13.7777 19.8362 13.7791 19.5391V15.1519L4.78835 20.9294C4.53906 21.091 4.25074 21.1821 3.9539 21.1932C3.65705 21.2043 3.36273 21.1349 3.10208 20.9925C2.84142 20.85 2.62412 20.6397 2.47318 20.3839C2.32223 20.128 2.24325 19.8362 2.24458 19.5391V7.73685C2.24325 7.4398 2.32223 7.14792 2.47318 6.89208C2.62412 6.63625 2.84142 6.42597 3.10208 6.28351C3.36273 6.14104 3.65705 6.07169 3.9539 6.08278C4.25074 6.09388 4.53906 6.18501 4.78835 6.34653L13.7791 12.1241V7.73685C13.7777 7.4398 13.8567 7.14792 14.0077 6.89208C14.1586 6.63625 14.3759 6.42597 14.6366 6.28351C14.8972 6.14104 15.1916 6.07169 15.4884 6.08278C15.7852 6.09388 16.0736 6.18501 16.3229 6.34653L25.5093 12.2477C25.7411 12.3978 25.9314 12.6039 26.0627 12.8468C26.1941 13.0897 26.2623 13.3618 26.2611 13.638Z"
                            fill='#153047' />
                    </g>
                    <defs>
                        <clipPath id="clip0_104_1901">
                            <rect width="26.3646" height="26.3646" fill="white" transform="translate(0.18486 0.455688)" />
                        </clipPath>
                    </defs>
                </svg>
            </button>

        </div>
    </div>
</template>

<script>
import dropDown from './dropDown.vue';
export default {
    name: 'longBreakTime',
    components: {
        dropDown,
    },
    props: {
        closeBtn: parseInt
    },
    data() {
        return {
            longBreakTime: localStorage.getItem('longBreakTime'),
            longBreakTimeValue: localStorage.getItem('longBreakTime'),
            seconds: 0,
            showSeconds: 0,
            intervalId: null,
            isIconChanged: true,
            showDropdown: true,
        }
    },
    created() {
        this.showSeconds = this.padZero(this.showSeconds)
        document.addEventListener('click', this.handleDocumentClick);
        if (localStorage.getItem('longBreakTime') === null) {
            this.longBreakTime = 10
        }
        if (this.updateValue) {
            this.longBreakTime = localStorage.getItem('longBreakTime')
        }
        this.seconds = this.longBreakTime * 60
    },
    methods: {
        runOrpauseTimer() {
            if (this.isIconChanged) {
                this.intervalId = setInterval(this.decreasTime, 1000)
                this.isIconChanged = false
            } else {
                this.isIconChanged = true
                clearInterval(this.intervalId)
            }
        },
        decreasTime() {
            this.seconds--;
            this.longBreakTime = this.padZero(Math.floor(this.seconds / 60))
            this.showSeconds = this.padZero(this.seconds % 60)
        },
        toggleDropdown() {
            this.showDropdown = !this.showDropdown
        },
        handleDocumentClick(event) {
            if (this.$el.contains(event.target)) {
                return;
            } else {
                this.showDropdown = true;
            }
            if (localStorage.getItem('longBreakTime') !== this.longBreakTimeValue) {
                this.longBreakTimeValue = localStorage.getItem('longBreakTime')
                this.longBreakTime = localStorage.getItem('longBreakTime')
                this.seconds = this.longBreakTime * 60
                this.showSeconds = this.padZero(0)
            }
        },
        showModal(color) {
            this.$emit('showModal', color)
            console.log(color);
        },
        nextItem() {
            this.$emit('nextItem', 1)
        },
    },
    computed: {
        padZero() {
            return number => number.toString().padStart(2, '0');
        },
    },

}
</script>

<style></style>